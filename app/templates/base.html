<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Professional portfolio showcasing my work experience, projects, and skills in software development.">
    <meta name="keywords" content="software developer, portfolio, web development, programming, projects">
    <meta name="author" content="{{ name if name else 'Portfolio Owner' }}">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="{% block og_title %}{{ title }} - Professional Portfolio{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Professional portfolio showcasing my work experience, projects, and skills.{% endblock %}">
    <meta property="og:url" content="{{ url }}">
    <meta property="og:type" content="website">
    <meta property="og:image" content="{{ url_for('static', filename='img/logo.jpg') if url_for else '/static/img/logo.jpg' }}">
    
    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}{{ title }} - Professional Portfolio{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Professional portfolio showcasing my work experience, projects, and skills.{% endblock %}">
    
    <!-- Preconnect to external domains for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Modern font stack with optimized loading -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"></noscript>
    
    <!-- Main stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/main.css') if url_for else '/static/styles/main.css' }}">
    
    <!-- Favicon -->
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') if url_for else '/static/img/favicon.ico' }}" type="image/x-icon">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/logo.jpg') if url_for else '/static/img/logo.jpg' }}">
    
    <!-- Leaflet CSS for maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    
    <!-- Page-specific styles -->
    <style>
        /* Inline critical CSS for better performance */
        body {
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #e2e8f0 !important;
            background-color: #0f1419 !important;
            background: #0f1419 !important;
        }
        
        /* Loading skeleton */
        .loading-skeleton {
            background: linear-gradient(90deg, #2d3748 25%, #4a5568 50%, #2d3748 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Ensure smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Map container */
        #map { 
            height: 500px; 
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        /* Focus styles for accessibility */
        *:focus {
            outline: 2px solid #2563eb;
            outline-offset: 2px;
        }
    </style>
    
    <title>{% block title %}{{ title }}{% endblock %}</title>
    {% block extra_head %}{% endblock %}
</head>

<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Floating Shapes Background -->
    <div class="floating-shapes">
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
        <div class="floating-shape"></div>
    </div>
    
    <header class="nav-bar" role="banner">
        <div class="nav-content">
            <a href="/" class="nav-logo-link" aria-label="Home">
                <div class="nav-logo">
                    <img src="{{ url_for('static', filename='img/logo.svg') if url_for else '/static/img/logo.svg' }}" 
                         alt="Portfolio Logo" 
                         width="120" 
                         height="40" />
                </div>
            </a>
            <nav class="nav-menu" role="navigation" aria-label="Main navigation">
                {% for nav_item in navigation %}
                    <a href="{{ nav_item.url }}" 
                       class="nav-link {% if nav_item.active %}active{% endif %}"
                       {% if nav_item.active %}aria-current="page"{% endif %}>
                        {{ nav_item.name }}
                    </a>
                {% endfor %}
            </nav>
        </div>
    </header>

    {% block profile %}{% endblock %}

    <main id="main-content" role="main">
        {% block content %}{% endblock %}
    </main>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    
    {% block extra_scripts %}{% endblock %}

    <!-- Performance and Analytics (optional) -->
    <script>
        // Service Worker registration for PWA capabilities (optional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                // Uncomment to enable service worker
                // navigator.serviceWorker.register('/sw.js');
            });
        }
        
        // Enhanced animations and effects
        function initAnimations() {
            // Scroll-triggered animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);

            // Add animation classes to elements
            const animateElements = document.querySelectorAll('.experience-card, .education-card, .project-card, .hobby-card');
            animateElements.forEach((el, index) => {
                // Add staggered animation classes
                if (index % 2 === 0) {
                    el.classList.add('fade-in-up');
                } else {
                    el.classList.add('scale-in');
                }
                observer.observe(el);
            });

            // Add hover glow effects
            const cardElements = document.querySelectorAll('.experience-card, .education-card, .project-card');
            cardElements.forEach(card => {
                card.classList.add('hover-glow');
            });

            // Add pulse animation to profile picture
            const profilePic = document.querySelector('.profile-picture img');
            if (profilePic) {
                profilePic.classList.add('pulse-animation');
            }
        }

        // Initialize animations
        initAnimations();
        
        // Lazy loading images
        if ('IntersectionObserver' in window) {
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove('lazy');
                        imageObserver.unobserve(img);
                    }
                });
            });
            
            document.querySelectorAll('img[data-src]').forEach(img => {
                imageObserver.observe(img);
            });
        }
    </script>

</body>

</html>